CC = gcc
CFLAGS = -std=c89 -Wall -Wextra -pedantic -Werror -Wno-unused-function -g
SRC = $(wildcard src/*.c)
OBJ = $(SRC:.c=.o)

.PHONY: all clean debug

all: assignment-v1

debug: CFLAGS += -DDEBUG -fsanitize=address -fno-omit-frame-pointer
debug: all

assignment-v1: $(OBJ)
	@echo "\nBuilding executable...\n"
	@$(CC) $(CFLAGS) -o $@ $^ && \
	echo "\nBuild completed successfully!\n" || \
	(echo "\nBuild failed.\n" && false)
	@echo "\nRunning executable...\n"
	@./$@
	@echo "\nExecution completed successfully!\n"

%.o: %.c
	@echo "\r\033[1;34mCompiling $<\033[0m"
	@$(CC) $(CFLAGS) -c -o $@ $<
	@echo "\r\033[1;32mCompiled $<\033[0m"

clean:
	@echo "\nCleaning up...\n"
	@rm -f assignment-v* $(OBJ)
	@echo "\nClean up completed!\n"

.SILENT: all debug assignment-v1 %.o clean
